#!/bin/bash

set -e # exit immediately if a simple command exits with a non-zero status
set -u # report the usage of uninitialized variables

# Extract nginx package
tar xzvf nginx/nginx-1.24.0.tar.gz

# Extract pcre package
tar xzvf nginx/pcre2-10.42.tar.gz

# Build nginx package
pushd nginx-1.24.0
  ./configure \
    --prefix=${BOSH_INSTALL_TARGET} \
    --with-pcre=${BOSH_COMPILE_TARGET}/pcre2-10.42 \
    --with-http_ssl_module \
    --with-file-aio
  make
  make install
popd
